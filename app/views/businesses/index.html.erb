<p id="notice"><%= notice %></p>

<h1>Businesses</h1>

<%= search_form_for @q do |f| %>

  <%= f.label :business_name_cont %>
  <%= f.search_field :business_name_cont %>
  
  <%= f.label :url_cont %>
  <%= f.search_field :url_cont %>
  
  <%= f.label :email_cont %>
  <%= f.search_field :email_cont %>

  <%= f.submit %>
<% end %>

<table>
  <thead>
    <tr>
      <th><%= link_to "Business Name", update_business_order_path(:business_name) %></th>
      <th><%= link_to "Address", update_business_order_path(:address_id) %></th>
      <th><%= link_to "URL", update_business_order_path(:url) %></th>
      <th><%= link_to "Email", update_business_order_path(:email) %></th>
      <th><%= link_to "Primary Contact", update_business_order_path(:prim_contact_id) %></th>
      <th><%= link_to "Secondary Contact", update_business_order_path(:sec_contact_id) %></th>
      <th colspan="3"></th>
    </tr>
  </thead>

  <tbody>
    <% @businesses.each do |business| %>
      <tr>
        <td><%= business.business_name %></td>
        <td><%= link_to Address.where(["address_id = ?", business.address_id]).first.line_1, Address.where(["address_id = ?", business.address_id]).first %></td>
        <td><%= business.url %></td>
        <td><%= business.email %></td>
        <td><%= link_to Contact.where(["contact_id = ?", business.prim_contact_id]).first.last_name, Contact.where(["contact_id = ?", business.prim_contact_id]).first %></td>
        <td><%= link_to Contact.where(["contact_id = ?", business.sec_contact_id]).first.last_name, Contact.where(["contact_id = ?", business.sec_contact_id]).first %></td>
        <td><%= link_to 'Show', business %></td>
        <td><%= link_to 'Edit', edit_business_path(business) %></td>
        <td><%= link_to 'Destroy', business, method: :delete, data: { confirm: 'Are you sure?' } %></td>
      </tr>
    <% end %>
  </tbody>
</table>

<br>

<%= link_to 'New Business', new_business_path %>
